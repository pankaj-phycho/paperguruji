<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Guruji - Smart Study Assistant</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(135deg, #000000, #1a1a2e);
      color: #fff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow-x: hidden;
      opacity: 0;
      animation: fadeInPage 1.2s forwards;
    }

    @keyframes fadeInPage {
      to { opacity: 1; }
    }

    .container {
      width: 100%;
      max-width: 900px;
      padding: 30px;
      position: relative;
      z-index: 2;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
      margin-bottom: 30px;
      position: relative;
    }

    .header-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: #fff;
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.4s ease;
      backdrop-filter: blur(10px);
      font-weight: 500;
    }

    .header-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 255, 255, 0.3);
    }

    .logo-container {
      text-align: center;
      position: relative;
      padding: 10px 0;
    }

    h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 3.5rem;
      background: linear-gradient(to bottom, #00ffff, #ff00ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
      animation: gradientFlow 3s infinite alternate;
      position: relative;
      display: inline-block;
    }

    @keyframes gradientFlow {
      0% {
        background-position: 0% 50%;
      }
      100% {
        background-position: 100% 50%;
      }
    }

    h1::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(to right, #00ffff, #ff00ff);
      border-radius: 3px;
      transform: scaleX(0);
      transform-origin: left;
      animation: lineGrow 2s forwards;
    }

    @keyframes lineGrow {
      to {
        transform: scaleX(1);
      }
    }

    .search-container {
      position: relative;
      margin: 40px 0;
    }

    .search-bar {
      display: flex;
      align-items: center;
      background: rgba(0, 0, 0, 0.4);
      border-radius: 50px;
      padding: 5px 20px;
      box-shadow: 0 0 25px rgba(0, 255, 255, 0.4), 
                  0 0 35px rgba(255, 0, 255, 0.3);
      animation: pulse 3s infinite alternate;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(5px);
    }

    @keyframes pulse {
      0% {
        box-shadow: 0 0 25px rgba(0, 255, 255, 0.4), 
                    0 0 35px rgba(255, 0, 255, 0.3);
      }
      100% {
        box-shadow: 0 0 35px rgba(0, 255, 255, 0.6), 
                    0 0 45px rgba(255, 0, 255, 0.5);
      }
    }

    #question-input {
      flex-grow: 1;
      background: transparent;
      border: none;
      color: #fff;
      font-size: 1.2rem;
      padding: 18px 15px;
      outline: none;
    }

    #question-input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .action-buttons {
      display: flex;
      gap: 12px;
    }

    .icon-btn {
      background: linear-gradient(135deg, #00ffff, #ff00ff);
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .icon-btn::before {
      content: '';
      position: absolute;
      top: -5px;
      left: -5px;
      right: -5px;
      bottom: -5px;
      background: linear-gradient(135deg, #00ffff, #ff00ff);
      border-radius: 50%;
      z-index: -1;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .icon-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.7),
                  0 0 30px rgba(255, 0, 255, 0.5);
    }

    .icon-btn:hover::before {
      opacity: 1;
      animation: rotate 1.5s linear infinite;
    }

    @keyframes rotate {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(360deg);
      }
    }

    .icon-btn i {
      font-size: 20px;
      color: #000;
      z-index: 1;
    }

    /* Right arrow icon for send button */
    .send-arrow {
      position: relative;
      width: 20px;
      height: 20px;
    }

    .send-arrow::before {
      content: '';
      position: absolute;
      width: 12px;
      height: 12px;
      border-top: 3px solid #000;
      border-right: 3px solid #000;
      transform: rotate(45deg);
      top: 3px;
      left: 2px;
    }

    .send-arrow::after {
      content: '';
      position: absolute;
      width: 15px;
      height: 3px;
      background: #000;
      top: 8px;
      left: 0;
    }

    .welcome-container {
      height: 60px;
      margin: 25px 0;
      overflow: hidden;
      position: relative;
    }

    .welcome-text {
      font-size: 1.8rem;
      text-align: center;
      color: transparent;
      background: linear-gradient(to right, #00ffff, #ff00ff);
      -webkit-background-clip: text;
      background-clip: text;
      position: absolute;
      width: 100%;
      opacity: 0;
      transform: translateY(30px);
      animation: welcomeAnim 6s forwards;
    }

    @keyframes welcomeAnim {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }
      20% {
        opacity: 1;
        transform: translateY(0);
      }
      80% {
        opacity: 1;
        transform: translateY(0);
      }
      100% {
        opacity: 0;
        transform: translateY(-30px);
      }
    }

    /* Uploaded file display */
    .uploaded-file {
      display: flex;
      align-items: center;
      background: rgba(0, 255, 255, 0.1);
      border: 1px solid rgba(0, 255, 255, 0.3);
      border-radius: 8px;
      padding: 10px 15px;
      margin-top: 15px;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .file-info {
      flex-grow: 1;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .file-icon {
      font-size: 1.5rem;
      color: #00ffff;
    }

    .file-name {
      font-size: 0.9rem;
      color: #fff;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      max-width: 300px;
    }

    .remove-file {
      background: rgba(255, 0, 0, 0.2);
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .remove-file:hover {
      background: rgba(255, 0, 0, 0.4);
      transform: scale(1.1);
    }

    .remove-file i {
      color: #ff5555;
      font-size: 14px;
    }

    #response-container {
      margin-top: 30px;
      text-align: left;
      background: rgba(255, 255, 255, 0.05);
      padding: 25px;
      border-radius: 15px;
      white-space: pre-wrap;
      min-height: 150px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      transition: all 0.4s ease;
      line-height: 1.6;
    }

    #response-container:hover {
      box-shadow: 0 8px 25px rgba(0, 255, 255, 0.2);
      transform: translateY(-5px);
    }
    
    /* Suggested questions container */
    .suggested-questions {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-top: 25px;
      padding: 15px;
      background: rgba(0, 255, 255, 0.05);
      border-radius: 12px;
      border: 1px solid rgba(0, 255, 255, 0.1);
    }

    .suggested-question {
      background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(255, 0, 255, 0.1));
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      font-size: 0.9rem;
    }

    .suggested-question:hover {
      background: linear-gradient(135deg, rgba(0, 255, 255, 0.2), rgba(255, 0, 255, 0.2));
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 255, 255, 0.2);
    }
    
    /* Blinking cursor for typing animation */
    .typing-cursor {
      display: inline-block;
      width: 8px;
      height: 1.2rem;
      background-color: #00ffff;
      animation: blink 0.7s infinite;
      margin-left: 4px;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }


    .description {
      font-size: 1.1rem;
      line-height: 1.6;
      max-width: 700px;
      margin: 40px auto 20px;
      text-align: center;
      color: rgba(255, 255, 255, 0.7);
    }

    .loading-dots {
      display: inline-block;
      position: relative;
      width: 80px;
      height: 20px;
      text-align: center;
    }

    .loading-dots span {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #00ffff;
      margin: 0 5px;
      animation: bounce 1.5s infinite ease-in-out both;
      box-shadow: 0 0 10px #00ffff;
    }

    .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
    .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

    @keyframes bounce {
      0%, 80%, 100% { 
        transform: scale(0);
        opacity: 0.5;
      }
      40% { 
        transform: scale(1);
        opacity: 1;
      }
    }

    /* History Modal */
    #history-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background: linear-gradient(135deg, #0f0f1a, #1a1a2e);
      margin: 8% auto;
      padding: 30px;
      border: 1px solid rgba(0, 255, 255, 0.2);
      width: 85%;
      max-width: 700px;
      border-radius: 15px;
      color: #fff;
      box-shadow: 0 0 40px rgba(0, 255, 255, 0.3);
      position: relative;
      animation: modalAppear 0.5s ease-out;
    }

    @keyframes modalAppear {
      from {
        opacity: 0;
        transform: translateY(-50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .close-btn {
      color: #aaa;
      float: right;
      font-size: 32px;
      font-weight: bold;
      cursor: pointer;
      transition: color 0.3s;
      position: absolute;
      top: 15px;
      right: 20px;
    }

    .close-btn:hover {
      color: #00ffff;
      text-shadow: 0 0 10px #00ffff;
    }

    .history-item {
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding: 18px 0;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .history-item:hover {
      background: rgba(255, 255, 255, 0.05);
      padding-left: 10px;
    }

    .bg-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      overflow: hidden;
    }

    .bg-circle {
      position: absolute;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(0, 255, 255, 0.1) 0%, transparent 70%);
      animation: float 15s infinite linear;
    }

    .bg-circle:nth-child(1) {
      width: 300px;
      height: 300px;
      top: -150px;
      left: -150px;
      animation-delay: 0s;
      animation-duration: 25s;
    }

    .bg-circle:nth-child(2) {
      width: 200px;
      height: 200px;
      bottom: -100px;
      right: 20%;
      animation-delay: -5s;
      animation-duration: 20s;
    }

    .bg-circle:nth-child(3) {
      width: 400px;
      height: 400px;
      bottom: -200px;
      left: 30%;
      animation-delay: -10s;
      animation-duration: 30s;
    }

    @keyframes float {
      0% {
        transform: translate(0, 0) rotate(0deg);
      }
      50% {
        transform: translate(20px, 20px) rotate(180deg);
      }
      100% {
        transform: translate(0, 0) rotate(360deg);
      }
    }

    @media (max-width: 768px) {
      .container {
        padding: 20px;
      }
      
      h1 {
        font-size: 2.5rem;
      }
      
      .search-bar {
        padding: 5px 15px;
      }
      
      #question-input {
        font-size: 1rem;
        padding: 15px 10px;
      }
      
      .icon-btn {
        width: 45px;
        height: 45px;
      }
      
      .welcome-text {
        font-size: 1.5rem;
      }
      
      .file-name {
        max-width: 180px;
      }
      
      .suggested-questions {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="bg-animation">
    <div class="bg-circle"></div>
    <div class="bg-circle"></div>
    <div class="bg-circle"></div>
  </div>

  <div class="container">
    <header>
      <button class="header-btn" id="home-btn"><i class="fas fa-home"></i> Home</button>
      <div class="logo-container">
        <h1>AI GURUJI</h1>
      </div>
      <button class="header-btn" id="history-btn"><i class="fas fa-history"></i> History</button>
    </header>

    <main>
      <div class="search-container">
        <div class="search-bar">
          <input type="text" id="question-input" placeholder="Ask any question...">
          <div class="action-buttons">
            <input type="file" id="image-upload" accept="image/*" style="display:none;">
            <button class="icon-btn" id="camera-btn" title="Upload Image">
              <i class="fas fa-upload"></i>
            </button>
            <button class="icon-btn" id="send-btn" title="Send Question">
              <div class="send-arrow"></div>
            </button>
          </div>
        </div>
        
        <div id="uploaded-file-container" style="display: none;">
          <div class="uploaded-file">
            <div class="file-info">
              <i class="fas fa-file-image file-icon"></i>
              <span class="file-name" id="uploaded-file-name"></span>
            </div>
            <button class="remove-file" id="remove-file-btn" title="Remove file">
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
      </div>

      <div class="welcome-container">
        <p class="welcome-text">Welcome to AI Guruji</p>
      </div>
      
      <div id="response-container">
        <p>Hi! I'm AI Guruji, your smart study assistant. How can I help you today? 👋</p>
        <div class="suggested-questions">
          <div class="suggested-question" data-question="What is the Pythagorean theorem?">What is the Pythagorean theorem?</div>
          <div class="suggested-question" data-question="Explain Newton's laws of motion">Explain Newton's laws of motion</div>
          <div class="suggested-question" data-question="What is photosynthesis?">What is photosynthesis?</div>
          <div class="suggested-question" data-question="How do I solve quadratic equations?">How do I solve quadratic equations?</div>
          <div class="suggested-question" data-question="What are the states of matter?">What are the states of matter?</div>
          <div class="suggested-question" data-question="Explain the water cycle">Explain the water cycle</div>
          <div class="suggested-question" data-question="What is the periodic table?">What is the periodic table?</div>
          <div class="suggested-question" data-question="How does electricity work?">How does electricity work?</div>
          <div class="suggested-question" data-question="What is climate change?">What is climate change?</div>
          <div class="suggested-question" data-question="How do cells divide?">How do cells divide?</div>
        </div>
      </div>
      
      <p class="description">AI Guruji is your smart study buddy. Ask tough questions, upload notes, or take a picture – I'll explain everything in <strong>easy student language</strong>!</p>
    </main>
  </div>

  <div id="history-modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h2><i class="fas fa-history"></i> Conversation History</h2>
      <div id="history-content"></div>
    </div>
  </div>

  <script>
    const questionInput = document.getElementById('question-input');
    const responseContainer = document.getElementById('response-container');
    const historyBtn = document.getElementById('history-btn');
    const historyModal = document.getElementById('history-modal');
    const closeBtn = document.querySelector('.close-btn');
    const historyContent = document.getElementById('history-content');
    const imageUpload = document.getElementById('image-upload');
    const cameraBtn = document.getElementById('camera-btn');
    const sendBtn = document.getElementById('send-btn');
    const welcomeText = document.querySelector('.welcome-text');
    const uploadedFileContainer = document.getElementById('uploaded-file-container');
    const uploadedFileName = document.getElementById('uploaded-file-name');
    const removeFileBtn = document.getElementById('remove-file-btn');
    const suggestedQuestions = document.querySelectorAll('.suggested-question');

    let conversationHistory = [];
    let currentImageBase64 = null;
    let currentFileName = null;

    // Predefined answers for the most common questions
    const predefinedAnswers = {
      "What is the Pythagorean theorem?": `The Pythagorean theorem is a fundamental principle in geometry that states that in a right-angled triangle, the square of the length of the hypotenuse (the side opposite the right angle) is equal to the sum of the squares of the lengths of the other two sides. 📐

Mathematically, it's expressed as: a² + b² = c²

Where:
- a and b are the lengths of the two shorter sides (legs)
- c is the length of the hypotenuse

This theorem is named after the ancient Greek mathematician Pythagoras, and it's used extensively in mathematics, engineering, architecture, and physics.

For example, if a right triangle has sides of length 3 and 4, the hypotenuse would be:
3² + 4² = 9 + 16 = 25, so c = √25 = 5`,

      "Explain Newton's laws of motion": `Sir Isaac Newton's three laws of motion are fundamental principles that describe the relationship between a body and the forces acting upon it. 🚀

1. First Law (Law of Inertia): 
   An object at rest stays at rest, and an object in motion stays in motion with the same speed and in the same direction unless acted upon by an unbalanced force.

2. Second Law (F = ma):
   The acceleration of an object is directly proportional to the net force acting on it and inversely proportional to its mass. Formula: F = m × a

3. Third Law (Action-Reaction):
   For every action, there is an equal and opposite reaction. When one body exerts a force on another, the second body simultaneously exerts a force equal in magnitude and opposite in direction on the first body.

These laws form the foundation for classical mechanics and help explain how objects move in our universe!`,

      "What is photosynthesis?": `Photosynthesis is the amazing process plants use to convert light energy into chemical energy! 🌿☀️

Here's how it works:
1. Plants take in carbon dioxide (CO₂) from the air through tiny pores called stomata
2. They absorb water (H₂O) from the soil through their roots
3. Using chlorophyll (the green pigment in leaves), they capture sunlight energy
4. This energy converts CO₂ and H₂O into glucose (sugar) and oxygen (O₂)

The chemical equation is:
6CO₂ + 6H₂O + light energy → C₆H₁₂O₆ + 6O₂

This process is super important because:
- It produces oxygen that we breathe
- It creates food for the plant (and ultimately for animals and humans)
- It helps regulate CO₂ levels in the atmosphere

Without photosynthesis, life as we know it wouldn't exist!`,

      "How do I solve quadratic equations?": `Solving quadratic equations might seem tricky, but it's actually pretty straightforward once you know the methods! 🧠

A quadratic equation looks like: ax² + bx + c = 0

Here are the main ways to solve them:

1. Factoring:
   Find two numbers that multiply to give you 'a×c' and add to give you 'b'
   Example: x² + 5x + 6 = 0 factors to (x + 2)(x + 3) = 0

2. Quadratic Formula:
   The surefire method that always works: 
   x = [-b ± √(b² - 4ac)] / (2a)

3. Completing the Square:
   Rearrange the equation to form a perfect square trinomial

4. Graphing:
   Find where the parabola crosses the x-axis

The quadratic formula is your best friend for tricky equations! Remember: the expression under the square root (b² - 4ac) is called the discriminant and tells you about the nature of the roots.`,

      "What are the states of matter?": `Matter exists in different states depending on temperature and pressure! 🌡️ There are four main states:

1. Solid: 
   - Definite shape and volume
   - Particles are tightly packed and vibrate in place
   - Examples: ice, rock, metal

2. Liquid:
   - Definite volume but no definite shape (takes container's shape)
   - Particles can slide past each other
   - Examples: water, oil, juice

3. Gas:
   - No definite shape or volume
   - Particles move freely and spread out
   - Examples: air, oxygen, helium

4. Plasma:
   - Similar to gas but with charged particles
   - Found in stars, lightning, neon signs
   - Most common state of matter in the universe!

There's also Bose-Einstein condensate (super cold matter) and some other exotic states, but these four are the ones you'll encounter most often!`,

      "Explain the water cycle": `The water cycle is Earth's amazing natural recycling system! 💧🌎 It has four main stages:

1. Evaporation:
   - Sun heats water in oceans, lakes, and rivers
   - Water turns into vapor and rises into the air

2. Condensation:
   - Water vapor cools and forms clouds
   - Tiny water droplets come together

3. Precipitation:
   - Water falls back to Earth as rain, snow, sleet, or hail
   - This replenishes our water sources

4. Collection:
   - Water collects in oceans, lakes, rivers, and underground
   - The cycle begins again!

This continuous process:
- Distributes fresh water around the planet
- Helps regulate Earth's temperature
- Supports all life on Earth

The water you drink today might have been part of a dinosaur's bath millions of years ago! 🦕`,

      "What is the periodic table?": `The periodic table is like a organized family album of all the chemical elements! 🧪📊

Created by Dmitri Mendeleev, it arranges elements by:
- Atomic number (number of protons)
- Electron configuration
- Recurring chemical properties

Key features:
- Rows are called periods (7 total)
- Columns are called groups (18 total)
- Elements in the same group have similar properties

Main categories:
1. Metals: Left side (shiny, conductive)
2. Nonmetals: Right side (dull, insulating)
3. Metalloids: Staircase line (mixed properties)

The table helps scientists:
- Predict element properties
- Understand chemical reactions
- Discover new elements

There are 118 confirmed elements, from Hydrogen (1) to Oganesson (118). Each element has its own symbol, atomic number, and atomic weight!`,

      "How does electricity work?": `Electricity is the flow of tiny particles called electrons! ⚡

Here's the basic idea:

1. Atoms have electrons that can move between atoms
2. When electrons flow in a consistent direction, we get electric current
3. This flow is powered by voltage (electrical pressure)
4. Resistance controls how much current can flow

Think of it like water flowing through a pipe:
- Voltage = Water pressure
- Current = Flow rate
- Resistance = Pipe narrowness

Types of electricity:
1. Static electricity: Stationary charge (like rubbing a balloon)
2. Current electricity: Flowing charge (what powers devices)

Circuits need:
- Power source (battery/generator)
- Conductive path (wires)
- Load (device using electricity)
- Switch (to control flow)

Electricity is amazing because it can be converted to light, heat, motion, and much more!`,

      "What is climate change?": `Climate change refers to long-term shifts in temperature and weather patterns on Earth. 🌍🌡️

Main causes:
1. Greenhouse effect: Certain gases trap heat in the atmosphere
2. Human activities: Burning fossil fuels, deforestation, agriculture
3. Natural factors: Volcanic eruptions, solar variations

Key impacts:
- Rising global temperatures
- Melting ice caps and glaciers
- Sea level rise
- More extreme weather events
- Changes in ecosystems

The main greenhouse gases are:
- Carbon dioxide (CO₂) from burning fuels
- Methane (CH₄) from agriculture and waste
- Nitrous oxide (N₂O) from fertilizers

Solutions include:
- Switching to renewable energy
- Reducing waste and consumption
- Protecting forests
- Sustainable agriculture

Climate change affects everyone, but we can all help make a difference! ♻️`,

      "How do cells divide?": `Cells divide through two main processes: mitosis and meiosis! 🔬

1. Mitosis (for growth and repair):
   - Creates two identical daughter cells
   - Each with the same number of chromosomes as the parent
   - Has four phases: prophase, metaphase, anaphase, telophase
   - Used for body cell reproduction

2. Meiosis (for sexual reproduction):
   - Creates four genetically unique cells
   - Each with half the number of chromosomes
   - Has two division stages: meiosis I and meiosis II
   - Produces gametes (sperm and egg cells)

The cell cycle has three main parts:
1. Interphase: Cell grows and DNA replicates
2. Mitosis/Meiosis: Nucleus divides
3. Cytokinesis: Cytoplasm divides

This process is crucial for:
- Growth of organisms
- Repairing damaged tissues
- Reproduction
- Maintaining life

Your body creates millions of new cells every second through cell division!`
    };

    function init() {
      const savedHistory = localStorage.getItem('aiGurujiHistory');
      if (savedHistory) {
        conversationHistory = JSON.parse(savedHistory);
        updateHistory();
      }
      setupEventListeners();
      setTimeout(() => {
        welcomeText.style.animation = 'none';
        setTimeout(() => {
          welcomeText.style.animation = 'welcomeAnim 6s forwards';
        }, 10);
      }, 500);
    }

    function setupEventListeners() {
      questionInput.addEventListener('keypress', e => {
        if(e.key === 'Enter' && (questionInput.value.trim() !== '' || currentImageBase64)) {
          getAIResponse(questionInput.value.trim() || "Explain this image", currentImageBase64);
        }
      });

      sendBtn.addEventListener('click', () => {
        if(questionInput.value.trim() !== '' || currentImageBase64) {
          getAIResponse(questionInput.value.trim() || "Explain this image", currentImageBase64);
        }
      });

      cameraBtn.addEventListener('click', () => {
        imageUpload.click();
      });

      imageUpload.addEventListener('change', e => {
        const file = e.target.files[0];
        if(file) {
          currentFileName = file.name;
          uploadedFileName.textContent = currentFileName;
          uploadedFileContainer.style.display = 'block';
          const reader = new FileReader();
          reader.onloadend = () => {
            currentImageBase64 = reader.result.replace(/^data:.+;base64,/, '');
          };
          reader.readAsDataURL(file);
        }
      });

      removeFileBtn.addEventListener('click', () => {
        currentImageBase64 = null;
        currentFileName = null;
        uploadedFileContainer.style.display = 'none';
        imageUpload.value = '';
      });

      historyBtn.onclick = () => {
        historyModal.style.display = 'block';
        updateHistory();
      };
      
      closeBtn.onclick = () => historyModal.style.display = 'none';
      
      window.onclick = (e) => { 
        if(e.target == historyModal) {
          historyModal.style.display = 'none';
        } 
      };
      
      // Add event listeners to suggested questions
      suggestedQuestions.forEach(question => {
        question.addEventListener('click', () => {
          const questionText = question.getAttribute('data-question');
          questionInput.value = questionText;
          getAIResponse(questionText);
        });
      });
    }
    
    function typeWriter(element, text, speed) {
        element.innerHTML = "";
        let i = 0;
        const cursor = '<span class="typing-cursor"></span>';
        element.innerHTML = cursor;
        
        function type() {
            if (i < text.length) {
                element.innerHTML = text.substring(0, i + 1) + cursor;
                i++;
                setTimeout(type, speed);
            } else {
                element.innerHTML = text;
                // Add suggested questions after the answer
                addSuggestedQuestions();
            }
        }
        type();
    }
    
    function addSuggestedQuestions() {
      const questionsHTML = `
        <div class="suggested-questions">
          <div class="suggested-question" data-question="What is the Pythagorean theorem?">What is the Pythagorean theorem?</div>
          <div class="suggested-question" data-question="Explain Newton's laws of motion">Explain Newton's laws of motion</div>
          <div class="suggested-question" data-question="What is photosynthesis?">What is photosynthesis?</div>
          <div class="suggested-question" data-question="How do I solve quadratic equations?">How do I solve quadratic equations?</div>
          <div class="suggested-question" data-question="What are the states of matter?">What are the states of matter?</div>
          <div class="suggested-question" data-question="Explain the water cycle">Explain the water cycle</div>
          <div class="suggested-question" data-question="What is the periodic table?">What is the periodic table?</div>
          <div class="suggested-question" data-question="How does electricity work?">How does electricity work?</div>
          <div class="suggested-question" data-question="What is climate change?">What is climate change?</div>
          <div class="suggested-question" data-question="How do cells divide?">How do cells divide?</div>
        </div>
      `;
      
      responseContainer.innerHTML += questionsHTML;
      
      // Reattach event listeners to the new suggested questions
      document.querySelectorAll('.suggested-question').forEach(question => {
        question.addEventListener('click', () => {
          const questionText = question.getAttribute('data-question');
          questionInput.value = questionText;
          getAIResponse(questionText);
        });
      });
    }

    async function getAIResponse(prompt, imageBase64 = null) {
      responseContainer.innerHTML = `
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      `;

      try {
        // Check if we have a predefined answer for this question
        let textResponse = predefinedAnswers[prompt] || 
          "I'm AI Guruji, your study assistant! I can help explain concepts from math, science, history and more. Try asking me about the Pythagorean theorem, Newton's laws, or any other topic you're studying! 📚✨";

        // For non-predefined questions, provide a generic response
        if (!predefinedAnswers[prompt]) {
          textResponse = `Thanks for your question: "${prompt}"! 🤔
          
I'm AI Guruji, your smart study assistant. While I have detailed answers prepared for many common study questions, I'm always learning more!

Try asking me about:
- Math concepts like the Pythagorean theorem
- Science topics like Newton's laws or photosynthesis
- Or any other subject you need help with!

You can also click on any of the suggested questions below to get detailed explanations. 📖`;
        }

        // Simulate API delay
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        // Apply the typing animation to the response
        typeWriter(responseContainer, textResponse, 30);

        // For history, save the final formatted HTML
        const formattedResponseForHistory = textResponse
          .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
          .replace(/\*(.*?)\*/g, '<em>$1</em>')
          .replace(/\n/g, '<br>');

        conversationHistory.push({
          question: prompt,
          answer: formattedResponseForHistory,
          timestamp: new Date().toLocaleString(),
          hasImage: imageBase64 ? true : false
        });

        localStorage.setItem('aiGurujiHistory', JSON.stringify(conversationHistory));
        updateHistory();

      } catch (err) {
        console.error("Error:", err);
        const errorMessage = `
          <div style="color: #ff5555;">
            <p><strong>Oh no! An error occurred. 😢</strong></p>
            <p>${err.message || "Something went wrong."}</p>
            <p>Please try again.</p>
          </div>
        `;
        responseContainer.innerHTML = errorMessage;
      }
    }

    function updateHistory(){
      historyContent.innerHTML = '';
      
      if (conversationHistory.length === 0) {
        historyContent.innerHTML = '<p>No conversation history yet.</p>';
        return;
      }
      
      const reversedHistory = [...conversationHistory].reverse();
      
      reversedHistory.forEach(item => {
        const historyItem = document.createElement('div');
        historyItem.className = 'history-item';
        
        const questionText = item.question.length > 50 ? 
          item.question.substring(0, 50) + '...' : item.question;
        
        historyItem.innerHTML = `
          <p><strong>You:</strong> ${questionText}</p>
          <p><small>${item.timestamp} ${item.hasImage ? '(with image) 📸' : ''}</small></p>
        `;
        
        historyItem.addEventListener('click', () => {
          responseContainer.innerHTML = item.answer;
          addSuggestedQuestions();
          questionInput.value = item.question;
          historyModal.style.display = 'none';
        });
        
        historyContent.appendChild(historyItem);
      });
    }

    init();
  </script>
</body>
</html>